void WeightedMean(){

vector<double> nom = {0.683775,0.662774,0.655868,0.6443324658,0.6390893383,0.6474616293,0.6423156444,0.6743589744,0.6707317073,0.7248677249,0.7169811321,0.6086956522,0.7142857143,0.7021986971,0.6933741601,0.6750769896,0.6632042038,0.6514522822,0.6503968254,0.6724003127,0.7352941176,0.7543859649,0.7163902226,0.7093799682,0.6883400183,0.6700490726,0.6523580586,0.7281553398,0.6645919779,0.6458055925,0.6417910448,0.7111126682,0.6847632897,0.6886591669,0.670332937,0.6395335673,0.6367062917,0.6166965889,0.6391096979,0.5940054496,0.7091979175,0.699626997,0.6973981488,0.69250501,0.6624919422,0.6523702032,0.6395604396,0.6584536958,0.6545454545,0.6946372787,0.6969327455,0.6952681841,0.6866558617,0.6706974368,0.656922043,0.6532001816,0.6601362862,0.6530035336,0.6917146862,0.6900423039,0.690059727,0.6979155864,0.6742658423,0.6524226712,0.6564981949,0.6587926509,0.6921928646,0.7019244476,0.6968442096,0.6942885916,0.678835289,0.6775184275,0.6485260771,0.6690590112,0.6642976589,0.6746306766,0.6889414548,0.7528735632,0.6801939765,0.6773309541,0.6742933198,0.6728333747,0.6745899102,0.6658752968,0.6539318688,0.6586807388,0.6440095398};

vector<double> uncert = {0.00319818,0.00336889,0.00339875,0.003562298191,0.004841781223,0.007341478091,0.01258318311,0.0167790677,0.02996276036,0.0324839811,0.06187619842,0.1017638475,0.1707469442,0.00412661662,0.004252457117,0.003442511573,0.003694330052,0.006138947241,0.009498972269,0.01312352251,0.03088853127,0.04031539918,0.004708611773,0.005725018712,0.003885346092,0.004288165697,0.005095100871,0.0438383107,0.01241595482,0.01745226433,0.04142024341,0.003793945064,0.004176027876,0.005709173923,0.008105038189,0.005108694954,0.008189396751,0.01456681215,0.01914917142,0.02563434852,0.003944803574,0.003845758166,0.003921780685,0.004131523286,0.004537717516,0.008551743623,0.009189157564,0.009774266716,0.02617630796,0.004290277929,0.004451085851,0.003900374336,0.004075004793,0.004336819514,0.005024307764,0.007170349631,0.009775076298,0.01265441497,0.004074962191,0.004171361174,0.006754427511,0.004675838734,0.005318687421,0.006367483569,0.006380084013,0.008587684485,0.005639594934,0.005461281032,0.005492356497,0.005525889462,0.005619881764,0.005792363543,0.006562969084,0.007671814559,0.009655570924,0.006327209606,0.01125746028,0.03269986828,0.00372561093,0.003732104563,0.003730884339,0.003696727596,0.003686225905,0.003728287016,0.003796016442,0.004871113748,0.004010204195};

double num = 0;
double den = 0;

for(int i = 0; i < nom.size();i++){

num += nom[i]*(1/(uncert[i]*uncert[i]));
den += (1/(uncert[i]*uncert[i]));

}

//Now find the uncertainty

double errorSum = 0;
for(int j = 0; j < uncert.size();j++){
errorSum += 1/(uncert[j]*uncert[j]*den*den);
}

cout << "The weighted mean is: " << num/den << endl;
cout << "The uncertainty is  : " << sqrt(errorSum) << endl;

//That uncertainty is too small.  Let's be conservative and take the largest deviation.

double largestDev = 0;

for(int k = 0; k < nom.size(); k++){
double mean = num/den;
if(fabs(mean - nom[k]) > largestDev) largestDev = fabs(mean - nom[k]);
}
cout << "The final largest deviation: " << largestDev << endl;

}
